## Specfile for OpenSuSE Build Service

%define packagename  qx11grab-@QX11GRAB_VERSION@

Name:           qx11grab
Summary:        qt4 applet for recording x11 windows with ffmpeg
Summary(de):    Qt4 Programm zum Aufnehmen von X11 Fenstern mit ffmpeg
Version:        @QX11GRAB_VERSION@
Release:        0
License:        GPLv2+
AutoReqProv:    on
Source0:        %{_sourcedir}/%packagename.tar.bz2
Group:          Productivity/Multimedia/Other
Url:            http://qx11grab.hjcms.de
BuildRoot:      %{_tmppath}/%{name}-%{version}-build
Requires:       ffmpeg
BuildRequires:  cmake >= 2.8.0 ffmpeg-devel
%if %{defined suse_version}
BuildRequires:  libqt4-devel >= 4.6.0 update-desktop-files
%else
BuildRequires:  qt4-devel >= 4.6.0
%endif 
Vendor:         Juergen Heinemann (Undefined) http://www.hjcms.de

%description
qt4 applet for recording x11 windows with ffmpeg
this prgramm requires ffmpeg from http://ffmpeg.mplayerhq.hu

before run this application please test with your xterm or console
that ffmpeg installation support this feature:
  ffmpeg -f x11grab -s svga -r 24 -b 6500 -bt 256k -sameq -i :0.0+1,33 /tmp/out.avi

Help: --------------
  http://ffmpeg.mplayerhq.hu/ffmpeg-doc.html#SEC4
  https://lists.mplayerhq.hu/mailman/listinfo

Author: -------------
  Juergen Heinemann (Undefined)
  http://www.hjcms.de

%description -l de
Ein Qt Basierendes Programm zum Aufnehmen von X11 Fenstern.
Das Programm verwendet ffmpeg von http://ffmpeg.mplayerhq.hu

Bevor sie das Programm verwenden bitte testen sie zuerst auf dem terminal oder console
ob ihre ffmpeg Installation diese funktion unterst√ºtzt:
  ffmpeg -f x11grab -s svga -r 24 -b 6500 -bt 256k -sameq -i :0.0+1,33 /tmp/out.avi

Hilfe: --------------
  http://ffmpeg.mplayerhq.hu/ffmpeg-doc.html#SEC4
  https://lists.mplayerhq.hu/mailman/listinfo

Autor: -------------
  Juergen Heinemann (Undefined)
  http://www.hjcms.de

%package ffpresets
Summary:        QX11Grab ffpreset Files for FFmpeg
Group:          Productivity/Editors/Other
BuildArch:      noarch
Supplements:    packageand(ffpresets:ffmpeg)

%description ffpresets
ffpreset Files for FFmpeg

Author:
-------------
  Juergen Heinemann (Undefined)
  http://www.hjcms.de

%prep
%setup -q

%__mkdir_p build

%build

cd build
cmake -Wno-dev \
  -DCMAKE_CXX_FLAGS:STRING="$RPM_OPT_FLAGS" \
  -DCMAKE_INSTALL_PREFIX:PATH=/usr \
  -DCMAKE_BUILD_TYPE:STRING=MinSizeRel \
  -DCMAKE_VERBOSE_MAKEFILE:BOOL=ON \
  -DINSTALL_FFPRESETS:BOOL=ON \
  ../

%__make

%install

pushd build
  %makeinstall
popd

%if %{defined suse_version}
%suse_update_desktop_file qx11grab -r Utility DesktopUtility
%endif 

%post
#

%postun
#

%files
%defattr(-, root, root)
%dir %{_sysconfdir}/xdg/hjcms.de
%config %{_sysconfdir}/xdg/hjcms.de/qx11grab.conf
%{_bindir}/qx11grab
%{_datadir}/qt*/translations/qx11grab*.qm
%dir %{_datadir}/qx11grab
%doc %{_datadir}/qx11grab/AUTHORS
%doc %{_datadir}/qx11grab/COPYING
%doc %{_datadir}/qx11grab/ChangeLog
%doc %{_datadir}/qx11grab/NEWS
%doc %{_datadir}/qx11grab/README
%{_datadir}/qx11grab/qx11grab_untranslated.ts
%{_datadir}/applications/qx11grab.desktop
%{_datadir}/pixmaps/qx11grab.png
%{_datadir}/dbus-1/services/*.qx11grab.service

%post ffpresets
##

%postun ffpresets
##

%files ffpresets
%defattr(-,root,root,-)
%dir %{_datadir}/ffmpeg
%{_datadir}/ffmpeg/*.ffpreset

%clean
rm -rf %{buildroot}

%changelog
#eof
